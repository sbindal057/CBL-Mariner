From 413aa6906f35ca45991435ebbe007ce1a65d2b57 Mon Sep 17 00:00:00 2001
From: Suresh Thelkar <sthelkar@microsoft.com>
Date: Tue, 12 Sep 2023 11:14:18 +0530
Subject: [PATCH] Backported the patch for CVE-2023-41910 from upstream

Following are the details of the patch used to backport
https://github.com/lldpd/lldpd/commit/a9aeabdf879c25c584852a0bb5523837632f099b
---
 src/daemon/protocols/cdp.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/daemon/protocols/cdp.c b/src/daemon/protocols/cdp.c
index 06da59e..3bfc956 100644
--- a/src/daemon/protocols/cdp.c
+++ b/src/daemon/protocols/cdp.c
@@ -485,6 +485,7 @@ cdp_decode(struct lldpd *cfg, char *frame, int s,
 					goto malformed;
 				}
 				PEEK_DISCARD(address_len);
+                addresses_len -= address_len;
 				(void)PEEK_SAVE(pos_next_address);
 				/* Next, we go back and try to extract
 				   IPv4 address */
-- 
2.38.1

